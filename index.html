<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="A mathematical path puzzle game">
    <title>PATH PUZZLE</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ðŸ§®</text></svg>">
    
    <!-- Preload critical resources -->
    <link rel="preload" href="styles/main.css" as="style">
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="styles/main.css">

    <!-- Import map for React -->
    <script type="importmap">
    {
      "imports": {
        "react": "https://esm.sh/react@18.2.0",
        "react-dom": "https://esm.sh/react-dom@18.2.0",
        "react-dom/client": "https://esm.sh/react-dom@18.2.0/client"
      }
    }
    </script>
    
    <!-- Module Preloading -->
    <link rel="modulepreload" href="js/gameLogic.js">
    <link rel="modulepreload" href="js/pathGenerator.js">
    <link rel="modulepreload" href="js/sequenceGenerator.js">
    <link rel="modulepreload" href="js/gridRenderer.js">
    <link rel="modulepreload" href="js/scoreBox.js">
    <link rel="modulepreload" href="js/rules.js">
    
    <style>
        .level-buttons {
            display: flex;
            justify-content: center;
            gap: 10px;
        }
        
        .game-controls {
            display: flex;
            justify-content: center;
            gap: 10px;
        }
    </style>
</head>
<body>
    <noscript>You need to enable JavaScript to run this game.</noscript>

    <!-- React Rules Component Container -->
    <div id="rules-container"></div>

    <div class="game-container">
        <!-- Header Section -->
        <header class="game-header">
            <h1>PATH PUZZLE</h1>
            
            <!-- Score Display -->
            <div class="score-display">
                <div id="score-component"></div>
                <span id="score" style="display: none;">0</span>
            </div>
        </header>

        <!-- Level Selector -->
        <section class="level-selector">
            <div class="level-buttons">
                <button class="level-btn" data-level="1">Level 1</button>
                <button class="level-btn" data-level="2">Level 2</button>
                <button class="level-btn" data-level="3">Level 3</button>
                <button class="level-btn" data-level="4">Level 4</button>
                <button class="level-btn" data-level="5">Level 5</button>
            </div>
        </section>

        <!-- Main Game Area -->
        <main class="game-board">
            <!-- Grid Container -->
            <div id="grid-container"></div>
            
            <!-- Sequence Container -->
            <div class="sequence-container" style="display: none;">
                <div id="sequence-sums" class="sequence-list"></div>
            </div>
            
            <!-- Game Controls -->
            <div class="game-controls">
                <button id="check-solution" disabled>
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M20 6 9 17l-5-5"/>
                    </svg>
                    Check Solution
                </button>
                
                <button id="remove-spare" disabled>
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <line x1="18" y1="6" x2="6" y2="18"/>
                        <line x1="6" y1="6" x2="18" y2="18"/>
                    </svg>
                    Remove Spare Cells
                </button>
            </div>

            <!-- Game Messages -->
            <div id="game-messages" class="message-box"></div>
        </main>
        
        <!-- Rules Overlay -->
        <div class="command-box">
            <div class="title">RULES</div>
            <div class="content">
                <h3>How to Play</h3>
                <ol>
                    <li>Select a difficulty level</li>
                    <li>Find the path by following the mathematical sequence, from green to red</li>
                    <li>Move to adjacent cells only, left / right / up / down; you cannot go back to the same cell</li>
                    <li>The answer to each sum is the first number in the next sum</li>
                </ol>
                
                <h3>More</h3>
                <ol>
                    <li>You can remove spare cells in two stages:
                        <ul>
                            <li>First removal: 50% of spare cells (cost: 1/2 points)</li>
                            <li>Second removal: remaining spare cells (cost: 1/2 points)</li>
                        </ul>
                    </li>
                    <li>You can check whether you've made any mistakes, but the right Maths doesn't always mean you're on the right path (cost: 1/4 points)</li>
                    <li>Bonus points depend on time, updating every 10 seconds</li>
                </ol>
            </div>
        </div>
    </div>

    <!-- Game Modules -->
    <script type="module" src="js/gameLogic.js"></script>
    <script type="module" src="js/pathGenerator.js"></script>
    <script type="module" src="js/sequenceGenerator.js"></script>
    <script type="module" src="js/gridRenderer.js"></script>
    <script type="module" src="js/scoreBox.js"></script>
    <script type="module" src="js/rules.js"></script>

    <!-- React Component Mounting -->
    <script type="module">
        import React from 'react';
        import ReactDOM from 'react-dom/client';
        import Rules from './js/rules.js';
        
        ReactDOM.createRoot(document.getElementById('rules-container')).render(
            React.createElement(Rules)
        );
    </script>
</body>
</html>
